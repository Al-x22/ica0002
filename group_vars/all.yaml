#Restart agama and mysql when changing mysql_host
mysql_host: mysql2
mysql_database: agama
mysql_user: agama
mysql_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32613264626130363433383235396134316330633566353731353736363663333932333430393130
          3838653737323132616261646131343633383733363731640a613865353637373136366466666264
          32326165383530316566616665353834313766666465356531393739356266396561383836633335
          3539626434646339330a386166313530666662626531386338633962303464626233343566386330
          3139

#Sql-exporter user and password
sql_exporter_user: mysql
sql_exporter_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          63336433306165336639373361333032303536396364626237313134376232376135656536656339
          3065356265386537616261633163373638346136633566370a636338636438313466656439326132
          35363339363436633434346565653337666335646632393837616431643432396130316338383565
          3463356633333963390a333861323032616566663430636434643831373961623031313262623130
          6637

backup_user: backup
mysql_backup_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          62323465383830316561333237323464373061663539336637303961643339313862316165613837
          6438626130396536313339633932633064636564323663320a396663663637626236623061326361
          35633866336132386437303831326434373831393832613762323130343634626365653530303334
          3130383635336161330a663764313439306264306337353364323261343235326666616330653361
          6433
sql_repl_user: replication
sql_repl_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66303438616632393034343561303435316166353133616436626339376236666130303962333065
          3337616638303336313732326233623564323135306435370a633966326534346437363433333861
          33643665333533383532346164393232393261363034323039633236666663383135343838313033
          3664383966303363350a653132616435386464363262623939663464353132333835303564363266
          3537
# For Bind email user
default_user: ubuntu
dns_transfer_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30333330363234343563633530393630366635623565623431633261623630653339316333343233
          3339323932626332663365303333303533393061303036630a393233353263353136653836376566
          62376233383337636563613130393439383233663336323835663237376531333464353139643234
          3631346636656262310a663931396336613430663733323464306135326637643063326535663035
          62366361626363623866376466666131383163383331306130623033343038666465626333383866
          3630663935356161666431633838306339313931303738633436
dns_nsupdate_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          36303332366637313461333132316463653533383065346139393233376231623734306364663833
          3065323138646531366637393839343862613137346237350a373666636664376331333765303234
          63663933373238323664306132623636633864313231323364343361616531356534303830623466
          6662356466316536640a326532316665346638646139666136613663646333306639666232623866
          38613863653661353266616265613030373664653132346466373833316466383764633634313636
          3331666632336233316661373061343465383266376631626232
node_id: "{{ (ansible_port / 100) | int }}"
# dnsvars
startup_name: alba.pz # Use tag sname after changing

allowed_addresses:
  -  192.168.42.0/23
  -  172.17.0.0/16
  -  127.0.0.0/8
forwarders:
  -  1.1.1.1
  -  8.8.8.8

backup_server_ip: 192.168.42.132
backup_server_ssh_key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
mysql_backup_host: "{{ groups['db_servers'] | reject('eq', mysql_host) | first | default(mysql_host) }}"

mysql_port: 3306

prometheus_port: 9090
influxdb_port: 8086

agama_port: 8001
agama_container_range: 2

haproxy_stats_port: 9188
haproxy_uri: monitor
ka_version: 1.2.0
ka_master: lb1

# Prometheus Jobs Ports
node_exporter_port: 9100
bind_exporter_port: 9119
mysql_exporter_port: 9104
nginx_exporter_port: 9113
influxdb_exporter_port: 9324
haproxy_exporter_port: 9101
keepalived_exporter_port: 9165

prometheus_jobs:
  - name: linux
    target_port: "{{ node_exporter_port }}"
    target_group:
      - Al-x22-1
      - Al-x22-2
      - Al-x22-3
  - name: bind9
    target_port: "{{ bind_exporter_port }}"
    target_group:
      - ns1
      - ns2
      - ns3
  - name: mysql
    target_port: "{{ mysql_exporter_port }}"
    target_group:
      - mysql1
      - mysql2
  - name: nginx
    target_port: "{{ nginx_exporter_port }}"
    target_group: 
      - web1
      - web2
      - web3
  - name: influxdb
    target_port: "{{ influxdb_exporter_port }}"
    target_group: 
      - influxdb
  - name: haproxy
    target_port: "{{ haproxy_exporter_port }}"
    target_group: 
      -  lb1
      -  lb2
  - name: keepalived
    target_port: "{{ keepalived_exporter_port }}"
    target_group: 
      -  lb1
      -  lb2

# Grafana

grafana_port: 3001
grafana_user: alex22
grafana_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31333765306662356437346365333133666563343831383839656638663735653636343162323533
          6134393866633139396632666137643736626363653936300a386166613733336662616461306432
          62393338313434353666363734306566646461613438343665646135393434326664656265623664
          3637333636626664620a373136306262323161313864653631316263663866643762346463633530
          3430
          
pinger_pings:
  -  google.com
  -  cloudflare.com
  -  twitter.com
  -  facebook.com

# Grafana

vrrp_instance: uni
virtual_router_id: 1

dns_a_records:
  backup: "{{ backup_server_ip }}"
  
dns_cname_records:
  grafana: "{{ groups['grafana_servers'][0] }}" #Alex 3
  influxdb: "{{ groups['influxdb_servers'][0] }}" #Alex 3
  lb1: "{{ groups['haproxy_servers'][0] }}" #Alex 1
  lb2: "{{ groups['haproxy_servers'][1] }}" #Alex 2
  mysql1: "{{ groups['db_servers'][0] }}" #Alex 1
  mysql2: "{{ groups['db_servers'][1] }}" #Alex 2
  ns1: "{{ groups['dns_servers'][0] }}" #Alex 3
  ns2: "{{ groups['dns_servers'][1] }}" #Alex 1 
  ns3: "{{ groups['dns_servers'][2] }}" #Alex 2
  prometheus: "{{ groups['prometheus_servers'][0] }}" #Alex 3
  web1: "{{ groups['web_servers'][0] }}" #Alex 1
  web2: "{{ groups['web_servers'][1] }}" #Alex 2
  web3: "{{ groups['web_servers'][2] }}" #Alex 3
